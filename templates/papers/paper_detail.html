{% extends 'base/base.html' %}

{% block title %}{{ paper.title }} | PYQ Analyzer{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto px-4 py-8">
  <div class="flex items-start justify-between gap-4">
    <div>
      <h1 class="text-2xl font-semibold text-gray-900">{{ paper.title }}</h1>
      <p class="mt-1 text-sm text-gray-600">
        {% if paper.year %}Year: {{ paper.year }}{% endif %}
        {% if paper.exam_type %}{% if paper.year %} • {% endif %}{{ paper.exam_type }}{% endif %}
      </p>
      <p class="mt-1 text-sm text-gray-600">Status: <span class="font-medium">{{ paper.get_status_display }}</span></p>
      {% if paper.processing_error %}
        <p class="mt-2 text-sm text-red-700">{{ paper.processing_error }}</p>
      {% endif %}
    </div>

    <div class="flex items-center gap-2">
      <a class="px-4 py-2 rounded-md bg-gray-100 text-gray-800 hover:bg-gray-200 text-sm" href="{% url 'subjects:detail' pk=paper.subject_id %}">Back</a>
      <a class="px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 text-sm" href="{{ paper.file.url }}" target="_blank" rel="noopener">Open PDF</a>
    </div>
  </div>

  <div class="mt-6 bg-white rounded-lg border border-gray-200 overflow-hidden">
    <div class="px-4 py-3 border-b border-gray-200 flex items-center justify-between">
      <h2 class="text-base font-semibold text-gray-900">Extracted Questions</h2>
      <span class="text-sm text-gray-600">{{ questions|length }} total</span>
    </div>

    {% if questions %}
      <div class="divide-y divide-gray-200">
        {% for q in questions %}
          <div class="p-4">
            <div class="flex items-start justify-between gap-4">
              <div class="min-w-0">
                <p class="text-sm font-medium text-gray-900">
                  Q{{ q.question_number }}{% if q.part %} ({{ q.part }}){% endif %}
                  {% if q.marks %}<span class="text-gray-500"> • {{ q.marks }} marks</span>{% endif %}
                </p>
                {% if q.module %}
                  <p class="mt-1 text-xs text-gray-600">Module: {{ q.module.name }}</p>
                {% endif %}
              </div>
            </div>
            <div class="mt-2 text-sm text-gray-800 whitespace-pre-wrap">{{ q.text }}</div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="p-6">
        <p class="text-sm text-gray-600">No questions extracted yet. Run processing from the subject page.</p>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}
